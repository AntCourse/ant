<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kzsrm.model.SignMapper">
	<resultMap id="signMap" type="com.kzsrm.model.Sign">
		<id column="id" jdbcType="INTEGER" property="id" />
		<result column="uid" jdbcType="INTEGER" property="uid" />
		<result column="lastSignDay" jdbcType="TIMESTAMP" property="lastSignDay" />
		<result column="startSignDay" jdbcType="TIMESTAMP" property="startSignDay" />
		<result column="antCoin" jdbcType="INTEGER" property="antCoin" />
		<result column="signNum" jdbcType="VARCHAR" property="signNum" />
	</resultMap>
	<!-- 添加打卡记录 -->
	<insert id="insertSign" parameterType="map" keyProperty="id"
		useGeneratedKeys="true">
		insert into sign
		(uid,startSignDay,lastSignDay,antCoin,signNum)
		values(#{uid,jdbcType=INTEGER},#{startSignDay,jdbcType=TIMESTAMP},#{lastSignDay,jdbcType=TIMESTAMP},#{antCoin
		,jdbcType=VARCHAR},#{signNum,jdbcType=VARCHAR})
	</insert>

	<!-- 获取该用户今天是否已打卡 -->
	<select id="getSignNum" parameterType="java.lang.Integer"
		resultMap="signMap">
		select * from sign where uid = #{uid,jdbcType=INTEGER}
	</select>

	<update id="updateSign" parameterType="map">
		update sign
		<set>
			<if test="signNum != null and signNum != ''">
				signNum =
				#{signNum,jdbcType=VARCHAR},
			</if>
			<if test="antCoin != null">
				antCoin = #{antCoin,jdbcType=INTEGER},
			</if>
			<if test="startSignDay != null">
				startSignDay=#{startSignDay,jdbcType=TIMESTAMP},
			</if>
			<if test="lastSignDay != null">
				lastSignDay = #{lastSignDay,jdbcType=TIMESTAMP}
			</if>
			where uid =
			#{uid,jdbcType=INTEGER}
		</set>
	</update>
</mapper>